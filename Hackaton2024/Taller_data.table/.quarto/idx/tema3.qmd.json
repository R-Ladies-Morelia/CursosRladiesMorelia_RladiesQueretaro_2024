{"title":"Filtros y selección de columnas","markdown":{"yaml":{"title":"Filtros y selección de columnas","format":{"html":{"page-layout":"full"}}},"headingText":"Operaciones sobre las filas","containsRefs":false,"markdown":"\n\n```{r}\n#| echo: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(data.table)\n```\n\n\n## Seleccionar por índices\n\nSimilar a como se seleccionan filas en un data.frame, en un objeto data.table se pueden seleccionar filas utilizando rangos de índices. En los siguientes dos ejemplos se muestra como seleccionar las primeras dos filas de la tabla de registros. \n\n\n```{r}\n#| echo: false\n#| warning: false\n\ndata = fread(\"data/head_registros.csv\")\n```\n\n```{.r}\nlibrary(data.table)\n\n\ndata = fread(\"data/plantae_mexico_conCoords_specimen.csv\")\n```\n\n```{r}\ndata[1:2] \n```\n\n<br>\n\n**Nota:** Cuando solo estamos seleccionando filas no es necesario incluir la coma al final.\n\n```{r}\ndata[1:2,] \n```\n\n<br>\n\n## Filtrar filas\n\nDe acuerdo con la sintaxis del paquete, el espacio i es el lugar en el que se pueden realizar operaciones sobre las filas como los filtros. Por ejemplo, utilizando la tabla de registros de especies de plantas podríamos estar interesados en solo seleccionar aquellos registros que pertenezcan al género Quercus. \n\n```{.r}\ndata_quercus <- data[genus == \"Quercus\",] \n\ndim(data_quercus)\n```\n\n```{r}\n#| echo: false\n\ndata_quercus <- fread(\"data/data_quercus.csv\")\ndim(data_quercus)\n\n```\n\nO podríamos estar interesadas en seleccionar solo los registros más viejos, los que fueron colectados antes de 1950. \n\n```{.r}\ndata_quercus_viejos <- data[genus == \"Quercus\" & year <= 1950,]\n\ndim(data_quercus_viejos)\n```\n\n```{r}\n#| echo: false\ndata_quercus_viejos <- data_quercus[year <= 1950, ]\ndim(data_quercus_viejos)\n```\n\n\n<br>\n\n## Ordenar filas\n\nOtra función que se puede realizar en el espacio de las filas es ordenarlas. Por ejemplo, podríamos ordenar la tabla de registros del género Quercus por estado en orden alfabético.\n\n```{r}\n# Ordenar los datos de la tabla de registros de Quercus por estado en orden alfabetico\n\nordered_data = data_quercus[order(stateProvince)]\n\n# seleccionar la columna de estado como vector y seleccionar los valores únicos\n# mostrar solo los primeros valores\n\nunique(ordered_data$stateProvince) |> head()\n```\n\n::: {.callout-note collapse=\"true\"}\n## Ejercicio\n\n1. Carga el archivo de registros de plantas utilizando la función fread que revisamos en el tema anterior\n2. Utiliza un filtro para quedarte con las filas que pertenezcan a un género o especie que te guste\n3. Ordena de manera descendente por año\n\nPregunta:\n\n¿De qué año son los registros más nuevos y más viejos de la especie que escogiste? (selecciona utilizando rangos la primera y la última fila de la tabla)\n::: \n\n::: {.callout-note collapse=\"true\"}\n## Respuesta\n\n```{.r}\nlibrary(data.table)\n\ndata = fread(\"data/plantae_mexico_conCoords_specimen.csv\", quote=\"\")\n\ndata_quercus <- data[genus == \"Quercus\" & !is.na(year),] \n\ndata_quercus_ordenado <- data_quercus[order(-year)] \n\n# Una función útil en el paquete es la función .N que te permite guardar el número de observaciones en el grupo actual. En este caso solo tenemos un solo grupo y por lo tanto guarda el número de filas en la tabla.\n\ndata_quercus_ordenado[c(1,.N),] |> knitr::kable()\n\n```\n\n```{r}\n#| echo: false\n\ndata_quercus[!is.na(year),][order(-year)][c(1,.N)] |> knitr::kable()\n```\n:::\n\n<br>\n<br>\n\n# Operaciones sobre las columnas\n\n```{r}\n#| echo: false\n\ndata = fread(\"data/sub_100000_plantae_mexico_conCoords_specimen.csv\")\n\n```\n\n## Seleccionar columnas por índice\n\nDe acuerdo con la sintaxis del paquete, el espacio j nos permite realizar operaciones sobre las columnas. Una de esas operaciones es la selección de columnas. \n\nSe pueden seleccionar por medio de índices:\n\n```{r}\ndata[,7:8,]\n```\n\n\n## Seleccionar columnas por nombre\n```{r}\n\n```\n\nSe pueden seleccionar las columas por nombre y regresar como vector:\n\n```{r}\ndata[,species] |> head()\n```\n\nSe pueden seleccionar las columnas usando una lista y regresar como tabla:\n\n```{r}\ndata[,list(family,genus,species)]\n```\n\nUn atajo para no escribir `list()` es `.()`:\n\n```{r}\ndata[,.(family,genus,species)]\n```\n\nPara seleccionar columnas guardadas en una variable se puede utilizar el prefijo `..`:\n\n```{r}\nvariables <- c(\"family\",\"genus\",\"species\")\n\ndata[ , ..variables]\n```\n\n::: {.callout-note collapse=\"true\"}\n## Ejercicio\n\n1. Selecciona las columnas que contengan información acerca de la ubicación geográfica de los registros.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Respuesta\n\ninfo_geografica <- c(\"countryCode\", \"stateProvince\", \"decimalLatitude\", \"decimalLongitude\", \"coordinateUncertaintyInMeters\", \"elevation\")\n\n```{r}\nvars_info_geografica <- c(\"countryCode\", \"stateProvince\", \"decimalLatitude\", \"decimalLongitude\", \"coordinateUncertaintyInMeters\", \"elevation\")\n\ndata[,..vars_info_geografica,]\n```\n\n:::\n\n## Renombrar columnas\n\nEn el espacio de operaciones sobre las columnas también se pueden renombrar las columnas. \n\n```{r}\ndata[, .(especie = species, genero = genus)]\n```\n\n\n","srcMarkdownNoYaml":"\n\n```{r}\n#| echo: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(data.table)\n```\n\n# Operaciones sobre las filas\n\n## Seleccionar por índices\n\nSimilar a como se seleccionan filas en un data.frame, en un objeto data.table se pueden seleccionar filas utilizando rangos de índices. En los siguientes dos ejemplos se muestra como seleccionar las primeras dos filas de la tabla de registros. \n\n\n```{r}\n#| echo: false\n#| warning: false\n\ndata = fread(\"data/head_registros.csv\")\n```\n\n```{.r}\nlibrary(data.table)\n\n\ndata = fread(\"data/plantae_mexico_conCoords_specimen.csv\")\n```\n\n```{r}\ndata[1:2] \n```\n\n<br>\n\n**Nota:** Cuando solo estamos seleccionando filas no es necesario incluir la coma al final.\n\n```{r}\ndata[1:2,] \n```\n\n<br>\n\n## Filtrar filas\n\nDe acuerdo con la sintaxis del paquete, el espacio i es el lugar en el que se pueden realizar operaciones sobre las filas como los filtros. Por ejemplo, utilizando la tabla de registros de especies de plantas podríamos estar interesados en solo seleccionar aquellos registros que pertenezcan al género Quercus. \n\n```{.r}\ndata_quercus <- data[genus == \"Quercus\",] \n\ndim(data_quercus)\n```\n\n```{r}\n#| echo: false\n\ndata_quercus <- fread(\"data/data_quercus.csv\")\ndim(data_quercus)\n\n```\n\nO podríamos estar interesadas en seleccionar solo los registros más viejos, los que fueron colectados antes de 1950. \n\n```{.r}\ndata_quercus_viejos <- data[genus == \"Quercus\" & year <= 1950,]\n\ndim(data_quercus_viejos)\n```\n\n```{r}\n#| echo: false\ndata_quercus_viejos <- data_quercus[year <= 1950, ]\ndim(data_quercus_viejos)\n```\n\n\n<br>\n\n## Ordenar filas\n\nOtra función que se puede realizar en el espacio de las filas es ordenarlas. Por ejemplo, podríamos ordenar la tabla de registros del género Quercus por estado en orden alfabético.\n\n```{r}\n# Ordenar los datos de la tabla de registros de Quercus por estado en orden alfabetico\n\nordered_data = data_quercus[order(stateProvince)]\n\n# seleccionar la columna de estado como vector y seleccionar los valores únicos\n# mostrar solo los primeros valores\n\nunique(ordered_data$stateProvince) |> head()\n```\n\n::: {.callout-note collapse=\"true\"}\n## Ejercicio\n\n1. Carga el archivo de registros de plantas utilizando la función fread que revisamos en el tema anterior\n2. Utiliza un filtro para quedarte con las filas que pertenezcan a un género o especie que te guste\n3. Ordena de manera descendente por año\n\nPregunta:\n\n¿De qué año son los registros más nuevos y más viejos de la especie que escogiste? (selecciona utilizando rangos la primera y la última fila de la tabla)\n::: \n\n::: {.callout-note collapse=\"true\"}\n## Respuesta\n\n```{.r}\nlibrary(data.table)\n\ndata = fread(\"data/plantae_mexico_conCoords_specimen.csv\", quote=\"\")\n\ndata_quercus <- data[genus == \"Quercus\" & !is.na(year),] \n\ndata_quercus_ordenado <- data_quercus[order(-year)] \n\n# Una función útil en el paquete es la función .N que te permite guardar el número de observaciones en el grupo actual. En este caso solo tenemos un solo grupo y por lo tanto guarda el número de filas en la tabla.\n\ndata_quercus_ordenado[c(1,.N),] |> knitr::kable()\n\n```\n\n```{r}\n#| echo: false\n\ndata_quercus[!is.na(year),][order(-year)][c(1,.N)] |> knitr::kable()\n```\n:::\n\n<br>\n<br>\n\n# Operaciones sobre las columnas\n\n```{r}\n#| echo: false\n\ndata = fread(\"data/sub_100000_plantae_mexico_conCoords_specimen.csv\")\n\n```\n\n## Seleccionar columnas por índice\n\nDe acuerdo con la sintaxis del paquete, el espacio j nos permite realizar operaciones sobre las columnas. Una de esas operaciones es la selección de columnas. \n\nSe pueden seleccionar por medio de índices:\n\n```{r}\ndata[,7:8,]\n```\n\n\n## Seleccionar columnas por nombre\n```{r}\n\n```\n\nSe pueden seleccionar las columas por nombre y regresar como vector:\n\n```{r}\ndata[,species] |> head()\n```\n\nSe pueden seleccionar las columnas usando una lista y regresar como tabla:\n\n```{r}\ndata[,list(family,genus,species)]\n```\n\nUn atajo para no escribir `list()` es `.()`:\n\n```{r}\ndata[,.(family,genus,species)]\n```\n\nPara seleccionar columnas guardadas en una variable se puede utilizar el prefijo `..`:\n\n```{r}\nvariables <- c(\"family\",\"genus\",\"species\")\n\ndata[ , ..variables]\n```\n\n::: {.callout-note collapse=\"true\"}\n## Ejercicio\n\n1. Selecciona las columnas que contengan información acerca de la ubicación geográfica de los registros.\n:::\n\n::: {.callout-note collapse=\"true\"}\n## Respuesta\n\ninfo_geografica <- c(\"countryCode\", \"stateProvince\", \"decimalLatitude\", \"decimalLongitude\", \"coordinateUncertaintyInMeters\", \"elevation\")\n\n```{r}\nvars_info_geografica <- c(\"countryCode\", \"stateProvince\", \"decimalLatitude\", \"decimalLongitude\", \"coordinateUncertaintyInMeters\", \"elevation\")\n\ndata[,..vars_info_geografica,]\n```\n\n:::\n\n## Renombrar columnas\n\nEn el espacio de operaciones sobre las columnas también se pueden renombrar las columnas. \n\n```{r}\ndata[, .(especie = species, genero = genus)]\n```\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"tema3.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","knitr":{"opts_chunk":{"R.options":{"width":120}}},"theme":"flatly","code-wrap":true,"grid":{"body-width":"1000px"},"title":"Filtros y selección de columnas","page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}